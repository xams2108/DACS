"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isAbiFunction = isAbiFunction;
exports.getTransactionGasCost = getTransactionGasCost;
const get_gas_price_js_1 = require("../gas/get-gas-price.js");
const estimate_gas_cost_js_1 = require("./actions/estimate-gas-cost.js");
/**
 * @internal
 */
function isAbiFunction(item) {
    return !!(item &&
        typeof item === "object" &&
        "type" in item &&
        item.type === "function");
}
async function getTransactionGasCost(tx, from) {
    try {
        const gasCost = await (0, estimate_gas_cost_js_1.estimateGasCost)({
            transaction: tx,
            from,
        });
        const bufferCost = gasCost.wei / 10n;
        // Note: get tx.value AFTER estimateGasCost
        // add 10% extra gas cost to the estimate to ensure user buys enough to cover the tx cost
        return gasCost.wei + bufferCost;
    }
    catch {
        if (from) {
            // try again without passing from
            return await getTransactionGasCost(tx);
        }
        // fallback if both fail, use the tx value + 1M * gas price
        const gasPrice = await (0, get_gas_price_js_1.getGasPrice)({
            client: tx.client,
            chain: tx.chain,
        });
        return 1000000n * gasPrice;
    }
}
//# sourceMappingURL=utils.js.map