/*!
 * @antv/g-plugin-canvas-picker
 * @description A G plugin for picking in canvas
 * @version 2.1.23
 * @date 5/30/2025, 2:56:22 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@antv/g-lite")):"function"==typeof define&&define.amd?define(["exports","@antv/g-lite"],r):r(((t="undefined"!=typeof globalThis?globalThis:t||self).G=t.G||{},t.G.CanvasPicker={}),t.window.G)}(this,(function(t,r){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}function o(t,r,e){return(r=n(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function i(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function a(t,r){for(var e=0;r.length>e;e++){var o=r[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function u(t,r,e){return r&&a(t.prototype,r),e&&a(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function s(t,r){if(r&&("object"==e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function l(t,r){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},l(t,r)}function h(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);r>e;e++)n[e]=t[e];return n}function v(t,r){if(t){if("string"==typeof t)return h(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?h(t,r):void 0}}function y(){y=function(){return r};var t,r={},n=Object.prototype,o=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,r,e,n){Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{f({},"")}catch(t){f=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=Object.create((e&&e.prototype instanceof v?e:v).prototype);return f(i,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var f=l(r,e,n);if("normal"===f.type){if(o=n.done?4:2,f.arg===h)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=4,n.method="throw",n.arg=f.arg)}}}(r,n,new E(o||[])),!0),i}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function v(){}function p(){}function d(){}var g={};f(g,a,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(k([])));b&&b!==n&&o.call(b,a)&&(g=b);var w=d.prototype=v.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(r){f(t,r,(function(t){return this._invoke(r,t)}))}))}function P(t,r){function n(i,a,u,c){var f=l(t[i],t,a);if("throw"!==f.type){var s=f.arg,h=s.value;return h&&"object"==e(h)&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){n("next",t,u,c)}),(function(t){n("throw",t,u,c)})):r.resolve(h).then((function(t){s.value=t,u(s)}),(function(t){return n("throw",t,u,c)}))}c(f.arg)}var i;f(this,"_invoke",(function(t,e){function o(){return new r((function(r,o){n(t,e,r,o)}))}return i=i?i.then(o,o):o()}),!0)}function O(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,O(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){this.tryEntries.push(t)}function M(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function E(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function k(r){if(null!=r){var n=r[a];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var i=-1,u=function e(){for(;++i<r.length;)if(o.call(r,i))return e.value=r[i],e.done=!1,e;return e.value=t,e.done=!0,e};return u.next=u}}throw new TypeError(e(r)+" is not iterable")}return p.prototype=d,f(w,"constructor",d),f(d,"constructor",p),f(d,c,p.displayName="GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,f(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},r.awrap=function(t){return{__await:t}},x(P.prototype),f(P.prototype,u,(function(){return this})),r.AsyncIterator=P,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new P(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),f(w,c,"Generator"),f(w,a,(function(){return this})),f(w,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=k,E.prototype={constructor:E,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!r)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],f=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!f)throw Error("try statement without catch or finally");if(null!=i[0]&&u>=i[0]){if(c>u)return this.method="next",this.arg=t,n(c),!0;if(f>u)return n(f),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&this.prev>=n[0]&&n[2]>this.prev){var o=n;break}}o&&("break"===t||"continue"===t)&&r>=o[0]&&o[2]>=r&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),M(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;M(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:k(r),r:e,n:n},"next"===this.method&&(this.arg=t),h}},r}function p(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}var d="undefined"!=typeof Float32Array?Float32Array:Array;function g(){var t=new d(3);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function m(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)}),g(),function(){var t,r=(t=new d(2),d!=Float32Array&&(t[0]=0,t[1]=0),t)}();var b,w=g(),x=g(),P=g(),O=(b=new d(16),d!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0),b[0]=1,b[5]=1,b[10]=1,b[15]=1,b),S=function(){function t(){var e=this;i(this,t),this.isHit=function(t,n,o,i){var a=e.context.pointInPathPickerFactory[t.nodeName];if(a){var u=function(t,r){var e=r[0],n=r[1],o=r[2],i=r[3],a=r[4],u=r[5],c=r[6],f=r[7],s=r[8],l=r[9],h=r[10],v=r[11],y=r[12],p=r[13],d=r[14],g=r[15],m=e*u-n*a,b=e*c-o*a,w=e*f-i*a,x=n*c-o*u,P=n*f-i*u,O=o*f-i*c,S=s*p-l*y,M=s*d-h*y,E=s*g-v*y,k=l*d-h*p,j=l*g-v*p,A=h*g-v*d,I=m*A-b*j+w*k+x*E-P*M+O*S;return I?(t[0]=(u*A-c*j+f*k)*(I=1/I),t[1]=(o*j-n*A-i*k)*I,t[2]=(p*O-d*P+g*x)*I,t[3]=(h*P-l*O-v*x)*I,t[4]=(c*E-a*A-f*M)*I,t[5]=(e*A-o*E+i*M)*I,t[6]=(d*w-y*O-g*b)*I,t[7]=(s*O-h*w+v*b)*I,t[8]=(a*j-u*E+f*S)*I,t[9]=(n*E-e*j-i*S)*I,t[10]=(y*P-p*w+g*m)*I,t[11]=(l*w-s*P-v*m)*I,t[12]=(u*M-a*k-c*S)*I,t[13]=(e*k-n*M+o*S)*I,t[14]=(p*b-y*x-d*m)*I,t[15]=(s*x-l*b+h*m)*I,t):null}(O,o),c=function(t,r,e){var n=r[0],o=r[1],i=r[2],a=e[3]*n+e[7]*o+e[11]*i+e[15];return t[0]=(e[0]*n+e[4]*o+e[8]*i+e[12])/(a=a||1),t[1]=(e[1]*n+e[5]*o+e[9]*i+e[13])/a,t[2]=(e[2]*n+e[6]*o+e[10]*i+e[14])/a,t}(x,m(P,n[0],n[1],0),u);if(a(t,new r.Point(c[0],c[1]),i,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,r){var n=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),o=e.context.pathGeneratorFactory[t.nodeName];return o&&(n.beginPath(),o(n,t.parsedStyle),n.closePath()),n.isPointInPath(r.x,r.y)}}return u(t,[{key:"apply",value:function(r,e){var n,o=this,i=r.renderingService,a=r.renderingContext;this.context=r,this.runtime=e;var u=null===(n=a.root)||void 0===n?void 0:n.ownerDocument;i.hooks.pick.tapPromise(t.tag,function(){var t,r=(t=y().mark((function t(r){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",o.pick(u,r));case 1:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){p(i,n,o,a,u,"next",t)}function u(t){p(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}()),i.hooks.pickSync.tap(t.tag,(function(t){return o.pick(u,t)}))}},{key:"pick",value:function(t,e){var n,o=e.topmost,i=e.position,a=m(w,i.x,i.y,0),u=[],c=function(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=v(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return t.length>n?{done:!1,value:t[n++]}:{done:!0}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}(t.elementsFromBBox(a[0],a[1],a[0],a[1]));try{for(c.s();!(n=c.n()).done;){var f=n.value,s=f.getWorldTransform();if(this.isHit(f,a,s,!1)){var l=r.findClosestClipPathTarget(f);if(l){var h=l.parsedStyle.clipPath;if(this.isHit(h,a,h.getWorldTransform(),!0)){if(o)return e.picked=[f],e;u.push(f)}}else{if(o)return e.picked=[f],e;u.push(f)}}}}catch(t){c.e(t)}finally{c.f()}return e.picked=u,e}}])}();function M(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,i,a,u=[],c=!0,f=!1;try{if(i=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;c=!1}else for(;!(c=(n=i.call(e)).done)&&(u.push(n.value),u.length!==r);c=!0);}catch(t){f=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(f)throw o}}return u}}(t,r)||v(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}S.tag="CanvasPicker";var k=function(t,r,e){return r>t?r:t>e?e:t};function j(t,r,e){return{x:t*Math.cos(e)-r*Math.sin(e),y:t*Math.sin(e)+r*Math.cos(e)}}function A(t,r,e,n,o,i,a,u,c,f){var s,l,h,v,y,p=t,d=r,g=e,m=n,b=u,w=c,x=120*Math.PI/180,P=Math.PI/180*(+o||0),O=[];if(f)l=f[0],h=f[1],v=f[2],y=f[3];else{d=(s=j(p,d,-P)).y;var S=((p=s.x)-(b=(s=j(b,w,-P)).x))/2,M=(d-(w=s.y))/2,E=S*S/(g*g)+M*M/(m*m);E>1&&(g*=E=Math.sqrt(E),m*=E);var k=g*g,I=m*m,F=(i===a?-1:1)*Math.sqrt(Math.abs((k*I-k*M*M-I*S*S)/(k*M*M+I*S*S)));v=F*g*M/m+(p+b)/2,l=Math.asin(((d-(y=F*-m*S/g+(d+w)/2))/m*1e9|0)/1e9),h=Math.asin(((w-y)/m*1e9|0)/1e9),0>(l=v>p?Math.PI-l:l)&&(l=2*Math.PI+l),0>(h=v>b?Math.PI-h:h)&&(h=2*Math.PI+h),a&&l>h&&(l-=2*Math.PI),!a&&h>l&&(h-=2*Math.PI)}var T=h-l;if(Math.abs(T)>x){var C=h,_=b,G=w;O=A(b=v+g*Math.cos(h=l+x*(a&&h>l?1:-1)),w=y+m*Math.sin(h),g,m,o,0,a,_,G,[h,C,v,y])}T=h-l;var L=Math.cos(l),W=Math.sin(l),H=Math.cos(h),N=Math.sin(h),R=Math.tan(T/4),q=4/3*g*R,D=4/3*m*R,B=[p,d],Y=[p+q*W,d-D*L],U=[b+q*N,w-D*H],Q=[b,w];if(Y[0]=2*B[0]-Y[0],Y[1]=2*B[1]-Y[1],f)return Y.concat(U,Q,O);for(var X=[],Z=0,$=(O=Y.concat(U,Q,O)).length;$>Z;Z+=1)X[Z]=Z%2?j(O[Z-1],O[Z],P).y:j(O[Z],O[Z+1],P).x;return X}
/*!
   * @antv/g-math
   * @description Geometry util
   * @version 3.0.1
   * @date 5/30/2025, 2:53:11 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */function I(t,r,e,n){var o=t-e,i=r-n;return Math.sqrt(o*o+i*i)}function F(t,r,e,n,o,i){var a=-1,u=1/0,c=[e,n],f=20;i&&i>200&&(f=i/10);for(var s=1/f,l=s/10,h=0;f>=h;h++){var v=h*s,y=[o.apply(void 0,E(t.concat([v]))),o.apply(void 0,E(r.concat([v])))],p=I(c[0],c[1],y[0],y[1]);u>p&&(a=v,u=p)}if(0===a)return{x:t[0],y:r[0]};if(1===a){var d=t.length;return{x:t[d-1],y:r[d-1]}}u=1/0;for(var g=0;32>g&&1e-4<=l;g++){var m=a-l,b=a+l,w=[o.apply(void 0,E(t.concat([m]))),o.apply(void 0,E(r.concat([m])))],x=I(c[0],c[1],w[0],w[1]);if(m>=0&&u>x)a=m,u=x;else{var P=[o.apply(void 0,E(t.concat([b]))),o.apply(void 0,E(r.concat([b])))],O=I(c[0],c[1],P[0],P[1]);1>=b&&u>O?(a=b,u=O):l*=.5}}return{x:o.apply(void 0,E(t.concat([a]))),y:o.apply(void 0,E(r.concat([a])))}}function T(t,r,e,n,o,i){var a=[e-t,n-r];if(function(t,r){return t[0]===r[0]&&t[1]===r[1]}(a,[0,0]))return Math.sqrt((o-t)*(o-t)+(i-r)*(i-r));var u=[-a[1],a[0]];return function(t,r){var e=r[0],n=r[1],o=e*e+n*n;o>0&&(o=1/Math.sqrt(o)),t[0]=r[0]*o,t[1]=r[1]*o}(u,u),Math.abs(function(t,r){return t[0]*r[0]+t[1]*r[1]}([o-t,i-r],u))}function C(t,r,e,n,o){var i=1-o;return i*i*i*t+3*r*o*i*i+3*e*o*o*i+n*o*o*o}function _(t,r,e,n,o,i,a,u,c,f,s){var l=function(t,r,e,n,o,i,a,u,c,f,s){return F([t,e,o,a],[r,n,i,u],c,f,C,s)}(t,r,e,n,o,i,a,u,c,f,s);return I(l.x,l.y,c,f)}function G(t,r,e,n){var o=1-n;return o*o*t+2*n*o*r+n*n*e}function L(t,r,e,n,o,i,a,u){var c=function(t,r,e,n,o,i,a,u){return F([t,e,o],[r,n,i],a,u,G)}(t,r,e,n,o,i,a,u);return I(c.x,c.y,a,u)}function W(t,e,n){var o=t.parsedStyle,i=o.cx,a=o.cy,u=o.r,c=o.fill,f=o.stroke,s=o.lineWidth,l=o.increasedLineWidthForHitTesting,h=o.pointerEvents,v=void 0===h?"auto":h,y=((void 0===s?1:s)+(void 0===l?0:l))/2,p=I(void 0===i?0:i,void 0===a?0:a,e.x,e.y),d=M(r.isFillOrStrokeAffected(v,c,f),2),g=d[0],m=d[1];return g&&m||n?u+y>=p:g?u>=p:!!m&&(p>=u-y&&u+y>=p)}function H(t,r,e,n){return t/(e*e)+r/(n*n)}function N(t,e,n){var o=t.parsedStyle,i=o.cx,a=void 0===i?0:i,u=o.cy,c=void 0===u?0:u,f=o.rx,s=o.ry,l=o.lineWidth,h=void 0===l?1:l,v=o.increasedLineWidthForHitTesting,y=void 0===v?0:v,p=o.pointerEvents,d=e.x,g=e.y,m=M(r.isFillOrStrokeAffected(void 0===p?"auto":p,o.fill,o.stroke),2),b=m[0],w=m[1],x=(h+y)/2,P=(d-a)*(d-a),O=(g-c)*(g-c);return b&&w||n?1>=H(P,O,f+x,s+x):b?1>=H(P,O,f,s):!!w&&(H(P,O,f-x,s-x)>=1&&1>=H(P,O,f+x,s+x))}function R(t,r,e,n,o,i){return!(t>o||o>t+e||r>i||i>r+n)}function q(t,r,e,n,o,i,a,u){var c=(Math.atan2(u-r,a-t)+2*Math.PI)%(2*Math.PI),f={x:t+e*Math.cos(c),y:r+e*Math.sin(c)};return I(f.x,f.y,a,u)<=i/2}function D(t,r,e,n,o,i,a){var u=o/2;return!(Math.min(t,e)-u>i||i>Math.max(t,e)+u||Math.min(r,n)-u>a||a>Math.max(r,n)+u)&&T(t,r,e,n,i,a)<=o/2}function B(t,r,e,n,o){var i=t.length;if(2>i)return!1;for(var a=0;i-1>a;a++){if(D(t[a][0],t[a][1],t[a+1][0],t[a+1][1],r,e,n))return!0}if(o){var u=t[0],c=t[i-1];if(D(u[0],u[1],c[0],c[1],r,e,n))return!0}return!1}function Y(t){return 1e-6>Math.abs(t)?0:0>t?-1:1}function U(t,r,e){return!((e[0]-t[0])*(r[1]-t[1])!==(r[0]-t[0])*(e[1]-t[1])||Math.min(t[0],r[0])>e[0]||e[0]>Math.max(t[0],r[0])||Math.min(t[1],r[1])>e[1]||e[1]>Math.max(t[1],r[1]))}function Q(t,r,e){var n=!1,o=t.length;if(2>=o)return!1;for(var i=0;o>i;i++){var a=t[i],u=t[(i+1)%o];if(U(a,u,[r,e]))return!0;Y(a[1]-e)>0!=Y(u[1]-e)>0&&0>Y(r-(e-a[1])*(a[0]-u[0])/(a[1]-u[1])-a[0])&&(n=!n)}return n}function X(t,r,e){for(var n=!1,o=0;t.length>o;o++){if(n=Q(t[o],r,e))break}return n}function Z(t,e,n){var o=t.parsedStyle,i=o.x1,a=o.y1,u=o.x2,c=o.y2,f=o.lineWidth,s=void 0===f?1:f,l=o.increasedLineWidthForHitTesting,h=void 0===l?0:l,v=o.pointerEvents;return!(!M(r.isFillOrStrokeAffected(void 0===v?"auto":v,o.fill,o.stroke),2)[1]&&!n||!s)&&D(i,a,u,c,s+h,e.x,e.y)}function $(t,e,n,o,i,a){var u=t.parsedStyle,c=u.lineWidth,f=void 0===c?1:c,s=u.increasedLineWidthForHitTesting,l=void 0===s?0:s,h=u.d,v=u.pointerEvents,y=h.segments,p=h.hasArc,d=h.polylines,g=h.polygons,m=M(r.isFillOrStrokeAffected(void 0===v?"auto":v,(null==g?void 0:g.length)&&u.fill,u.stroke),2),b=m[0],w=m[1],x=r.getOrCalculatePathTotalLength(t),P=!1;return b||n?P=p?o(t,e):X(g,e.x,e.y)||X(d,e.x,e.y):((w||n)&&(P=function(t,r,e,n,o){for(var i=!1,a=r/2,u=0;t.length>u;u++){var c=t[u],f=c.currentPoint,s=c.params,l=c.prePoint,h=c.box;if(!h||R(h.x-a,h.y-a,h.width+r,h.height+r,e,n))switch(c.command){case"L":case"Z":if(i=D(l[0],l[1],f[0],f[1],r,e,n))return!0;break;case"Q":if(i=r/2>=L(l[0],l[1],s[1],s[2],s[3],s[4],e,n))return!0;break;case"C":if(i=r/2>=_(l[0],l[1],s[1],s[2],s[3],s[4],s[5],s[6],e,n,o))return!0;break;case"A":c.cubicParams||(c.cubicParams=A(l[0],l[1],s[1],s[2],s[3],s[4],s[5],s[6],s[7],void 0));for(var v=c.cubicParams,y=l,p=0;v.length>p;p+=6){var d=_(y[0],y[1],v[p],v[p+1],v[p+2],v[p+3],v[p+4],v[p+5],e,n,o);if(y=[v[p+4],v[p+5]],i=r/2>=d)return!0}}}return i}(y,f+l,e.x,e.y,x)),P)}function z(t,e,n){var o=t.parsedStyle,i=o.lineWidth,a=void 0===i?1:i,u=o.increasedLineWidthForHitTesting,c=void 0===u?0:u,f=o.points,s=o.pointerEvents,l=M(r.isFillOrStrokeAffected(void 0===s?"auto":s,o.fill,o.stroke),2),h=l[0],v=!1;return(l[1]||n)&&(v=B(f.points,a+c,e.x,e.y,!0)),v||!h&&!n||(v=Q(f.points,e.x,e.y)),v}function J(t,e,n){var o=t.parsedStyle,i=o.lineWidth,a=void 0===i?1:i,u=o.increasedLineWidthForHitTesting,c=void 0===u?0:u,f=o.points,s=o.pointerEvents;return!(!M(r.isFillOrStrokeAffected(void 0===s?"auto":s,o.fill,o.stroke),2)[1]&&!n||!a)&&B(f.points,a+c,e.x,e.y,!1)}function K(t,e,n,o,i){var a=t.parsedStyle,u=a.radius,c=a.lineWidth,f=void 0===c?1:c,s=a.increasedLineWidthForHitTesting,l=void 0===s?0:s,h=a.x,v=void 0===h?0:h,y=a.y,p=void 0===y?0:y,d=a.width,g=a.height,m=a.pointerEvents,b=M(r.isFillOrStrokeAffected(void 0===m?"auto":m,a.fill,a.stroke),2),w=b[0],x=b[1],P=f+l;if(u&&u.some((function(t){return 0!==t}))){var O=!1;return(x||n)&&(O=function(t,r,e,n,o,i,a,u){var c=M(o,4),f=c[0],s=c[1],l=c[2],h=c[3];return D(t+f,r,t+e-s,r,i,a,u)||D(t+e,r+s,t+e,r+n-l,i,a,u)||D(t+e-l,r+n,t+h,r+n,i,a,u)||D(t,r+n-h,t,r+f,i,a,u)||q(t+e-s,r+s,s,0,0,i,a,u)||q(t+e-l,r+n-l,l,0,0,i,a,u)||q(t+h,r+n-h,h,0,0,i,a,u)||q(t+f,r+f,f,0,0,i,a,u)}(v,p,d,g,u.map((function(t){return k(t,0,Math.min(Math.abs(d)/2,Math.abs(g)/2))})),P,e.x,e.y)),O||!w&&!n||(O=o(t,e)),O}var S=P/2;return w&&x||n?R(v-S,p-S,d+S,g+S,e.x,e.y):w?R(v,p,d,g,e.x,e.y):!!x&&function(t,r,e,n,o,i,a){var u=o/2;return R(t-u,r-u,e,o,i,a)||R(t+e-u,r-u,o,n,i,a)||R(t+u,r+n-u,e,o,i,a)||R(t-u,r+u,o,n,i,a)}(v,p,d,g,P,e.x,e.y)}function V(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function tt(t){for(var r=1;arguments.length>r;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?V(Object(e),!0).forEach((function(r){o(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):V(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function rt(t,e,n,o,i,a){var u=t.parsedStyle,c=u.pointerEvents,f=u.x,s=void 0===f?0:f,l=u.y,h=void 0===l?0:l,v=u.width,y=u.height;if("non-transparent-pixel"===(void 0===c?"auto":c)){var p=i.config.offscreenCanvas,d=a.offscreenCanvasCreator.getOrCreateCanvas(p),g=a.offscreenCanvasCreator.getOrCreateContext(p,{willReadFrequently:!0});return d.width=v,d.height=y,i.defaultStyleRendererFactory[r.Shape.IMAGE].render(g,tt(tt({},t.parsedStyle),{},{x:0,y:0}),t,void 0,void 0,void 0),g.getImageData(e.x-s,e.y-h,1,1).data.every((function(t){return 0!==t}))}return!0}function et(t,r,e,n){var o=t.getGeometryBounds();return!(o.min[0]>r.x||o.min[1]>r.y||r.x>o.max[0]||r.y>o.max[1])}var nt=function(t){function e(){var t,r,n,o;i(this,e);for(var a=arguments.length,u=Array(a),l=0;a>l;l++)u[l]=arguments[l];return r=this,n=e,o=[].concat(u),n=c(n),(t=s(r,f()?Reflect.construct(n,o||[],c(r).constructor):n.apply(r,o))).name="canvas-picker",t}return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&l(t,r)}(e,t),u(e,[{key:"init",value:function(){var t,e=(o(o(o(o(o(o(o(o(o(o(t={},r.Shape.CIRCLE,W),r.Shape.ELLIPSE,N),r.Shape.RECT,K),r.Shape.LINE,Z),r.Shape.POLYLINE,J),r.Shape.POLYGON,z),r.Shape.PATH,$),r.Shape.TEXT,et),r.Shape.GROUP,null),r.Shape.IMAGE,rt),o(o(t,r.Shape.HTML,null),r.Shape.MESH,null));this.context.pointInPathPickerFactory=e,this.addRenderingPlugin(new S)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(r.AbstractRendererPlugin);t.Plugin=nt}));
//# sourceMappingURL=index.umd.min.js.map
